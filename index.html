<!DOCTYPE html>
<html lang="zh-Hant">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>é›»æ©Ÿç§‘æ™ºæ…§é»é¤çµ±è¨ˆç³»çµ±ğŸ‘©ğŸ¼â€ğŸ³</title>
    <style>
        :root {
            --neon-blue: #00d4ff;
            --neon-purple: #9d00ff;
            --bg-dark: #0a0e14;
            --card-bg: rgba(22, 33, 46, 0.98);
            --open: #00ff88;
            --closed: #ff4d4d;
            --gold: #f1c40f;
            --orange: #ff9800;
            --row-paid: rgba(0, 255, 136, 0.15);
        }

        body {
            font-family: "PingFang TC", "Microsoft JhengHei", sans-serif;
            background-color: var(--bg-dark);
            background-image: radial-gradient(circle at 2px 2px, rgba(157, 0, 255, 0.1) 1px, transparent 0);
            background-size: 30px 30px;
            margin: 0; padding: 0; color: #e0e0e0;
        }

        header { background: rgba(10, 14, 20, 0.98); padding: 1.5rem; text-align: center; border-bottom: 2px solid var(--neon-blue); position: sticky; top: 0; z-index: 1000; }
        h1 { background: linear-gradient(90deg, var(--neon-blue), var(--neon-purple)); -webkit-background-clip: text; -webkit-text-fill-color: transparent; margin: 0; font-size: 1.8rem; }

        .tool-bar { background: rgba(0, 0, 0, 0.7); padding: 15px; display: flex; justify-content: center; gap: 12px; flex-wrap: wrap; }
        .btn-tech { background: transparent; color: var(--neon-blue); border: 1px solid var(--neon-blue); padding: 8px 18px; border-radius: 4px; cursor: pointer; font-weight: bold; transition: 0.3s; }
        .btn-tech:hover { background: var(--neon-blue); color: #000; box-shadow: 0 0 15px var(--neon-blue); }

        #wheel-overlay { display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.9); z-index: 2000; }
        #wheel-box { display: none; position: fixed; top: 50%; left: 50%; transform: translate(-50%, -50%); z-index: 2001; background: var(--card-bg); padding: 30px; border-radius: 20px; border: 2px solid var(--neon-purple); text-align: center; width: 340px; }
        #wheel { width: 280px; height: 280px; border-radius: 50%; border: 5px solid #333; transition: transform 4s cubic-bezier(0.15, 0, 0.15, 1); margin: 20px auto; position: relative; overflow: hidden; }
        .pointer { width: 0; height: 0; border-left: 15px solid transparent; border-right: 15px solid transparent; border-top: 30px solid red; position: absolute; top: 10px; left: 50%; transform: translateX(-50%); z-index: 2002; }

        .container { max-width: 1200px; margin: 20px auto; padding: 0 15px; }
        .grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(300px, 1fr)); gap: 25px; }
        .card { background: var(--card-bg); padding: 20px; border-radius: 10px; border: 1px solid rgba(157, 0, 255, 0.2); position: relative; }
        .status-badge { position: absolute; top: 15px; right: 15px; padding: 4px 8px; border-radius: 3px; font-size: 0.75rem; font-weight: bold; }
        .open { color: var(--open); border: 1px solid var(--open); }
        .closed { color: var(--closed); border: 1px solid var(--closed); }

        .order-system { background: rgba(22, 33, 46, 0.98); padding: 30px; border-radius: 12px; margin-top: 50px; border: 1px solid var(--neon-purple); }
        .store-field { background: transparent; border: none; border-bottom: 2px solid var(--gold); color: var(--gold); font-size: 1.2rem; font-weight: bold; width: 60%; outline: none; padding: 5px; }

        table { width: 100%; border-collapse: collapse; margin-top: 15px; }
        th, td { border: 1px solid rgba(255,255,255,0.05); padding: 12px; text-align: center; }
        th { color: var(--neon-purple); letter-spacing: 2px; font-size: 0.9rem; }
        select, input { background: #000; border: 1px solid #333; color: var(--neon-blue); padding: 8px; border-radius: 4px; width: 95%; box-sizing: border-box; }
        tr.paid { background-color: var(--row-paid); }
        
        .change-cell { color: var(--orange); font-weight: bold; font-size: 1.1rem; }
        .total-box { text-align: right; font-size: 1.8rem; font-weight: bold; color: var(--neon-blue); margin-top: 25px; text-shadow: 0 0 10px var(--neon-blue); }
    </style>
</head>
<body>

<header><h1>é›»æ©Ÿç§‘æ™ºæ…§é»é¤çµ±è¨ˆç³»çµ±ğŸ‘©ğŸ¼â€ğŸ³</h1></header>

<div class="tool-bar">
    <button class="btn-tech" onclick="openWheel('drink')">ğŸ¥¤ æŠ½é£²æ–™</button>
    <button class="btn-tech" onclick="openWheel('food')">ğŸœ æŠ½ç¾é£Ÿ</button>
    <button class="btn-tech" style="color:var(--gold); border-color:var(--gold);" onclick="renderStores(true)">ğŸ”¥ ç†±é–€</button>
    <button class="btn-tech" onclick="renderStores()">ğŸ”„ åˆ·æ–°ç‹€æ…‹</button>
</div>

<div id="wheel-overlay" onclick="closeWheel()"></div>
<div id="wheel-box">
    <h2 id="wheel-title" style="color:var(--neon-blue)">ğŸ¡ å‘½é‹ä¹‹è¼ª</h2>
    <div class="pointer"></div>
    <div id="wheel"></div>
    <button class="btn-tech" id="spin-btn" onclick="spinWheel()" style="width:100%; background:var(--neon-blue); color:#000;">é»æˆ‘æ—‹è½‰</button>
    <p id="wheel-result" style="margin-top:15px; font-weight:bold; color:var(--open); min-height: 24px;"></p>
    <button class="btn-tech" style="margin-top:10px; width:100%; border-color:#555; color:#888;" onclick="closeWheel()">é—œé–‰è½‰ç›¤</button>
</div>

<div class="container">
    <section id="drinks"><h2>ğŸ¥¤ é£²æ–™ä¾›æ‡‰éˆ</h2><div id="drinks-grid" class="grid"></div></section>
    <section id="food"><h2>ğŸœ èƒ½é‡è£œçµ¦ç«™</h2><div id="food-grid" class="grid"></div></section>

    <section id="order-tool">
        <div class="order-system">
            <div style="display:flex; justify-content:space-between; align-items:center;">
                <h2 style="color:var(--neon-purple); margin:0;">ğŸ“Š æ•¸æ“šçµ±è¨ˆè¡¨ (å«æ‰¾éŒ¢è¨ˆç®—)</h2>
                <button class="btn-tech" style="color:var(--closed); border-color:var(--closed);" onclick="resetData()">é‡æ•´çµ±è¨ˆè¡¨</button>
            </div>
            <div style="padding:15px 0;">
                æ­£åœ¨é»é¤ï¼š<input type="text" id="target-store-input" class="store-field" placeholder="é»æ“Šèœå–®æˆ–åœ¨æ­¤æ‰‹å‹•è¼¸å…¥...">
            </div>
            <table id="orderTable">
                <thead>
                    <tr>
                        <th width="8%">æ”¶éŒ¢</th>
                        <th width="20%">åå–®</th>
                        <th width="24%">å“é …å‚™è¨»</th>
                        <th width="12%">æ‡‰ä»˜ ($)</th>
                        <th width="12%">æ”¶å¤šå°‘ ($)</th>
                        <th width="12%">æ‡‰æ‰¾éŒ¢ ($)</th>
                        <th width="12%">åˆªé™¤</th>
                    </tr>
                </thead>
                <tbody></tbody>
            </table>
            <button onclick="addNewRow()" class="btn-tech" style="margin-top:20px; background:rgba(0, 212, 255, 0.1);">â• æ–°å¢ä¸€ç­†è¨˜éŒ„</button>
            <div class="total-box">é›»æ©Ÿç§‘ç¸½é‡‘é¡ï¼š$<span id="finalPrice">0</span></div>
        </div>
    </section>
</div>

<script>
const teachers = ["æ›¾è©©å±è€å¸«", "è”¡å²³éœ–è€å¸«", "å»–é›…å©·è€å¸«", "ç§‘ä¸»ä»»", "å¼·å“¥", "åŠ©æ•™"];
const stores = [
    { name: "æ¸…å¿ƒ åŸºéš†æµ·å¤§åº—", tel: "0224626266", link: "http://chingshin.tw/", cat: "drink", hot: false, time: { all: ["11:00", "22:45"] } },
    { name: "å¯ä¸å¯ åŸºéš†æ·±æºªåº—", tel: "0224659695", link: "https://kebuke.com/menu/", cat: "drink", hot: true, time: { all: ["10:00", "22:00"] } },
    { name: "50åµ åŸºéš†æ·±æºªåº—", tel: "0224683368", link: "https://order.nidin.shop/menu/21216", cat: "drink", hot: true, time: { all: ["10:00", "22:00"] } },
    { name: "é¾œè¨˜ åŸºéš†åº—", tel: "0224258889", link: "https://guiji.doteat.tw/menu?storeId=LEzDQINl-0000wKv98o&showBulletin=1", cat: "drink", hot: false, time: { all: ["11:00", "22:00"] } },
    { name: "è¿·å®¢å¤ åŸºéš†å»Ÿå£åº—", tel: "0224261766", link: "https://milksha.nidin.shop/menu/491", cat: "drink", hot: false, time: { all: ["10:00", "21:00"] } },
    { name: "äº”æ¡è™Ÿ åŸºéš†ä»ä¸‰åº—", tel: "0224283616", link: "https://www.wootea.com/menu/", cat: "drink", hot: true, time: { 1: null, all: ["11:00", "20:00"] } },
    { name: "æœ‰é£² åŸºéš†å»Ÿå£åº—", tel: "0224258827", link: "https://www.youindrink.com/pages/menu", cat: "drink", hot: false, time: { 1: ["11:00", "19:00"], 5: ["12:00", "20:00"], all: ["11:00", "19:00"] } },
    { name: "æ—é¦™æª¸ å°ç£å‰µå§‹åº—", tel: "0224270618", link: "https://www.lamheunglingoverseas.com/cz", cat: "drink", hot: false, time: { all: ["11:00", "21:00"] } },
    { name: "Mr.Wish åŸºéš†å»Ÿå£åº—", tel: "0224273456", link: "https://www.mr-wish.com/", cat: "drink", hot: false, time: { 1: null, all: ["11:00", "18:00"] } },
    { name: "Coco åŸºéš†æµ·æ´‹åº—", tel: "0224620586", link: "https://coco-tea.nidin.shop/menu/21237", cat: "drink", hot: false, time: { all: ["10:00", "21:45"] } },
    { name: "å¾—æ­£ #åŸºéš†æµ·å¤§", tel: "0224621016", link: "https://order.nidin.shop/menu/18739", cat: "drink", hot: true, time: { all: ["10:30", "21:30"] } },
    { name: "Comebuy åŸºéš†æ–°è±åº—", tel: "0224695668", link: "https://drive.google.com/file/d/1Rq51uQuxEv4VDxwoB-hDczLhqECx9Gu2/view?usp=sharing", cat: "drink", hot: false, time: { all: ["11:00", "22:00"] } },
    { name: "é¶´èŒ¶æ¨“ åŸºéš†å¿ ä¸€åº—", tel: "0224265572", link: "https://order.nidin.shop/menu/19710", cat: "drink", hot: false, time: { all: ["10:30", "20:00"] } },
    { name: "æ‹¾æ±£èŒ¶å±‹ åŸºéš†å»Ÿå£åº—", tel: "02-24247778", link: "https://www.19teahouse.com/works/detail/Store29", cat: "drink", hot: true, time: { all: ["10:30", "21:00"] } },
    { name: "æ°´é›²å ‚ åŸºéš†ç¾©äºŒåº—", tel: "0224261227", link: "https://www.drinkstore.com.tw/web/product/product.jsp", cat: "drink", hot: false, time: { all: ["10:00", "22:00"] } },
    { name: "è’Ÿè’»å±‹", tel: "0224229000", link: "https://drive.google.com/file/d/1T08WgpxufhYVOJ8sbfc7gvpthvoDaacY/view?usp=sharing", cat: "food", hot: true, time: { 5: ["09:00", "02:30"], 6: ["09:00", "02:30"], all: ["09:00", "02:00"] } },
    { name: "å¤§ç¢—ç‰›è‚‰éºµ", tel: "0224633396", link: "https://drive.google.com/file/d/12wii4UGfDTHYECO5ObXyS6qutY9qRcaX/view?usp=sharing", cat: "food", hot: true, time: { all: ["11:00", "20:00"] } },
    { name: "éº¥å…‹éºµç·š", tel: "0224236667", link: "https://maps.app.goo.gl/DNe9c5xbqTsyfBGE7", cat: "food", hot: false, time: { 3: ["06:00", "17:30"], 6: ["06:00", "16:30"], all: null } },
    { name: "è±†ä¹¾åŒ…", tel: "0224201711", link: "https://drive.google.com/file/d/18VeBd_w6HFvBD321t7Iu-QaNfko5CljQ/view?usp=sharing", cat: "food", hot: true, time: { all: ["10:00", "22:00"] } },
    { name: "ç¾é¦™é½‹æ»·å‘³", tel: "0224263357", link: "https://drive.google.com/file/d/1pjCLx6xivI5e_Ud1zmMglOFFZtsjDFij/view?usp=sharing", cat: "food", hot: false, time: { 0: null, all: ["10:45", "23:00"] } },
    { name: "é‚±è¨˜ç‚’éºµï¼ˆæ±ä¿¡åº—ï¼‰", tel: "0224680335", link: "https://drive.google.com/file/d/1zuEI_w-zwS9rIGRcekHsb_QXll1twyg3/view?usp=sharing", cat: "food", hot: true, time: { 6: null, all: ["11:00", "14:00", "17:00", "20:00"] } },
    { name: "å»–åª½åª½éºµé£¯é¤¨-æ–°è±åº—", tel: "0224680789", link: "https://drive.google.com/file/d/1j_SjavYZbnJjJHCJNSzVQaAzf_1e5Km0/view?usp=sharing", cat: "food", hot: true, time: { 0: null, all: ["11:00", "21:00"] } }
];

function checkStatus(s) {
    const now = new Date(); const day = now.getDay(); const currTotal = now.getHours() * 60 + now.getMinutes();
    let range = s.time[day] !== undefined ? s.time[day] : s.time.all;
    if (!range) return { s: "å·²æ‰“çƒŠ", c: "closed", msg: "ä»Šæ—¥å…¬ä¼‘" };
    if (range.length === 4) {
        let s1 = 11*60, e1 = 14*60, s2 = 17*60, e2 = 20*60;
        if ((currTotal >= s1 && currTotal < e1) || (currTotal >= s2 && currTotal < e2)) {
            let activeEnd = currTotal < e1 ? e1 : e2; let diff = activeEnd - currTotal;
            return { s: "ç‡Ÿæ¥­ä¸­", c: "open", msg: `å‰© ${Math.floor(diff/60)}æ™‚${diff%60}åˆ†` };
        }
        return { s: "ä¼‘æ¯ä¸­", c: "closed", msg: "åˆ†æ®µä¼‘æ¯" };
    }
    const [sH, sM] = range[0].split(":").map(Number); const [eH, eM] = range[1].split(":").map(Number);
    let sT = sH * 60 + sM, eT = eH * 60 + eM;
    if (eT < sT) { if (currTotal >= sT || currTotal < eT) {
        let diff = (currTotal >= sT) ? (1440 - currTotal + eT) : (eT - currTotal);
        return { s: "ç‡Ÿæ¥­ä¸­", c: "open", msg: `å‰© ${Math.floor(diff/60)}æ™‚${diff%60}åˆ†` };
    } } else if (currTotal >= sT && currTotal < eT) {
        let diff = eT - currTotal; return { s: "ç‡Ÿæ¥­ä¸­", c: "open", msg: `å‰© ${Math.floor(diff/60)}æ™‚${diff%60}åˆ†` };
    }
    return { s: "å·²æ‰“çƒŠ", c: "closed", msg: "ç›®å‰æ‰“çƒŠ" };
}

function renderStores(fHot = false) {
    const dG = document.getElementById('drinks-grid'); const fG = document.getElementById('food-grid');
    dG.innerHTML = ''; fG.innerHTML = '';
    stores.forEach(s => {
        if (fHot && !s.hot) return;
        const info = checkStatus(s);
        const card = `<div class="card"><span class="status-badge ${info.c}">${info.s}</span><h3 style="color:var(--neon-blue);margin:10px 0;">${s.name}</h3><div style="font-size:0.8rem;color:#aaa;">ğŸ“ ${s.tel}<br>â° ${info.msg}</div><div style="display:flex;gap:10px;margin-top:15px;"><a href="tel:${s.tel}" class="btn-tech" style="flex:1;text-decoration:none;text-align:center;">æ’¥æ‰“</a><a href="${s.link}" target="_blank" class="btn-tech" style="background:var(--neon-purple);color:#fff;border-color:var(--neon-purple);text-decoration:none;text-align:center;flex:2;" onclick="setOrderStore('${s.name}')">èœå–®</a></div></div>`;
        if (s.cat === 'drink') dG.innerHTML += card; else fG.innerHTML += card;
    });
}

function setOrderStore(n) { document.getElementById('target-store-input').value = n; }

function addNewRow() {
    const tbody = document.querySelector("#orderTable tbody");
    const row = tbody.insertRow();
    let opt = '<option value="">é¸æ“‡å¸«é•·...</option>';
    teachers.forEach(t => opt += `<option value="${t}">${t}</option>`);
    opt += '<option value="custom">â• æ‰‹å‹•è¼¸å…¥</option>';
    row.innerHTML = `
        <td><input type="checkbox" onchange="this.closest('tr').classList.toggle('paid', this.checked)"></td>
        <td><select onchange="handleName(this)">${opt}</select></td>
        <td><input type="text" placeholder="å¤§æ¯åŠç³–..."></td>
        <td><input type="number" class="price-val" oninput="calculateResults()"></td>
        <td><input type="number" class="received-val" oninput="calculateResults()" placeholder="æ”¶éŒ¢"></td>
        <td class="change-cell">0</td>
        <td><button style="color:red;background:none;border:none;cursor:pointer;" onclick="this.closest('tr').remove();calculateResults()">âŒ</button></td>
    `;
}

function handleName(s) {
    if (s.value === "custom") {
        const n = prompt("è¼¸å…¥åç¨±ï¼š");
        if (n) { let o = new Option(n, n); s.add(o, s.options[s.options.length-1]); s.value = n; }
        else s.value = "";
    }
}

function calculateResults() {
    let total = 0;
    document.querySelectorAll("#orderTable tbody tr").forEach(row => {
        let price = Number(row.querySelector(".price-val").value) || 0;
        let received = Number(row.querySelector(".received-val").value) || 0;
        let changeCell = row.querySelector(".change-cell");
        total += price;
        let change = received - price;
        changeCell.innerText = change > 0 ? change : 0;
    });
    document.getElementById("finalPrice").innerText = total;
}

function resetData() { if(confirm("ç¢ºå®šé‡æ•´çµ±è¨ˆè¡¨ï¼Ÿ")) { document.querySelector("#orderTable tbody").innerHTML = ''; setOrderStore(""); addNewRow(); calculateResults(); } }

let wItems = [], rotTotal = 0;
function openWheel(c) {
    wItems = stores.filter(s => s.cat === c);
    document.getElementById('wheel-title').innerText = (c==='drink'?'ğŸ¥¤ æŠ½é£²æ–™':'ğŸœ æŠ½ç¾é£Ÿ');
    document.getElementById('wheel-overlay').style.display = 'block'; document.getElementById('wheel-box').style.display = 'block';
    const w = document.getElementById('wheel'); w.innerHTML = '';
    wItems.forEach((s, i) => {
        const seg = document.createElement('div');
        seg.style.cssText = `position:absolute;width:100%;height:100%;background:${i%2?'#00d4ff':'#16212e'};clip-path:polygon(50% 50%, 50% 0, 100% 0);transform:rotate(${360/wItems.length*i}deg);`;
        w.appendChild(seg);
    });
}
function spinWheel() {
    const r = Math.floor(Math.random()*360)+1800; rotTotal += r;
    document.getElementById('wheel').style.transform = `rotate(${rotTotal}deg)`;
    setTimeout(() => {
        const idx = Math.floor((360 - (rotTotal % 360)) / (360/wItems.length)) % wItems.length;
        const result = wItems[idx];
        document.getElementById('wheel-result').innerText = `ğŸ‰ æŠ½ä¸­ï¼š${result.name}`;
        setOrderStore(result.name);
    }, 4000);
}
function closeWheel() { document.getElementById('wheel-overlay').style.display='none'; document.getElementById('wheel-box').style.display='none'; }

window.onload = () => { renderStores(); addNewRow(); };
</script>
</body>
</html>
