<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <title>WBC 2024ï¼šå®Œæ•´é™£å®¹ç©¶æ¥µç‰ˆ</title>
    <style>
        :root { --accent: #00f2ff; --bg: #020617; --panel: #1e293b; --strike: #facc15; --tw-blue: #0038a8; --jp-red: #bc002d; }
        body { background: var(--bg); color: #fff; font-family: 'Segoe UI', sans-serif; margin: 0; display: flex; flex-direction: column; align-items: center; overflow: hidden; height: 100vh; }
        
        #setup-screen { position: absolute; inset: 0; z-index: 1000; background: radial-gradient(circle, #001f3f, #000); padding: 20px; display: flex; flex-direction: column; align-items: center; overflow-y: auto; }
        .setup-container { display: flex; gap: 20px; width: 95%; max-width: 1200px; height: 65vh; }
        .pool-box { flex: 1; background: rgba(255,255,255,0.05); border: 1.5px solid var(--tw-blue); border-radius: 12px; overflow-y: auto; padding: 15px; }
        .p-item { background: #0f172a; padding: 8px; margin: 5px 0; border-radius: 6px; cursor: pointer; display: flex; justify-content: space-between; font-size: 0.85rem; border: 1px solid transparent; }
        .p-item:hover { border-color: var(--accent); }
        .p-item.selected { border-color: var(--strike); opacity: 0.4; pointer-events: none; }

        #game-screen { display: none; width: 100%; height: 100vh; flex-direction: column; }
        .line-score { width: 100%; background: #000; border-bottom: 2px solid var(--accent); padding: 5px 0; }
        .score-table { margin: 0 auto; border-collapse: collapse; font-family: monospace; text-align: center; }
        .score-table td, th { padding: 4px 10px; border: 1px solid #1e293b; }

        .main-layout { display: flex; flex: 1; width: 100%; position: relative; }
        .order-panel { width: 220px; background: rgba(0,0,0,0.85); padding: 15px; border-right: 1px solid #334155; }
        .order-item { padding: 4px; border-radius: 4px; margin-bottom: 2px; color: #555; font-size: 0.8rem; display: flex; justify-content: space-between; }
        .order-item.active { background: var(--accent); color: #000; font-weight: bold; }

        .canvas-container { flex: 1; position: relative; display: flex; justify-content: center; align-items: center; background: radial-gradient(circle, #1e293b, #050a15); }
        canvas { border-radius: 10px; border: 1px solid #334155; transition: transform 0.1s; }

        .sidebar { width: 280px; background: rgba(15, 23, 42, 0.95); padding: 20px; display: flex; flex-direction: column; gap: 15px; border-left: 1px solid #334155; }
        .pitch-menu { display: grid; grid-template-columns: 1fr 1fr; gap: 8px; }
        .btn { background: transparent; border: 1px solid var(--accent); color: var(--accent); padding: 8px; border-radius: 6px; cursor: pointer; font-size: 0.75rem; text-align: center; }
        .btn.active { background: var(--accent); color: #000; font-weight: bold; }
        .sub-btn { background: #334155; color: #fff; border: 1px solid #475569; padding: 8px; border-radius: 6px; cursor: pointer; font-size: 0.8rem; margin-top: 5px; }

        #sub-modal { display: none; position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%); background: #1e293b; border: 2px solid var(--accent); border-radius: 15px; padding: 20px; z-index: 2000; width: 300px; box-shadow: 0 0 50px #000; }
        .sub-item { padding: 10px; border-bottom: 1px solid #334155; cursor: pointer; font-size: 0.85rem; }

        #swing-btn { width: 100%; padding: 20px; font-size: 1.5rem; font-weight: 900; color: #fff; background: linear-gradient(to bottom, #ef4444, #991b1b); border: none; border-radius: 12px; cursor: pointer; box-shadow: 0 5px 0 #7f1d1d; }
        .light { width: 12px; height: 12px; border-radius: 50%; background: #2d3748; display: inline-block; margin: 0 4px; }
        .s-on { background: var(--strike); box-shadow: 0 0 10px var(--strike); }
        .b-on { background: #4ade80; box-shadow: 0 0 10px #4ade80; }
        .o-on { background: #ef4444; box-shadow: 0 0 10px #ef4444; }

        .feedback-overlay { position: absolute; top: 15%; display: flex; flex-direction: column; align-items: center; pointer-events: none; width: 100%; text-align: center; }
        #speed-text { font-size: 1.5rem; color: var(--accent); font-weight: bold; }
        #timing-text { font-size: 2rem; font-weight: 900; color: #fff; text-shadow: 0 0 10px #000; }
        #result-text { font-size: 2.5rem; font-weight: 900; color: var(--strike); text-shadow: 0 0 20px #000; }
        #start-btn { margin-top: 20px; padding: 12px 50px; background: var(--tw-blue); color: white; border: none; border-radius: 30px; cursor: pointer; display: none; }
    </style>
</head>
<body>

<div id="setup-screen">
    <h1 style="color:var(--accent)">WBC 2024ï¼šå®Œæ•´é™£å®¹ç‰ˆ</h1>
    <h3 id="setup-status">æŒ‘é¸ 9 æ‰“è€… + 1 æŠ•æ‰‹ (åå–®å·²è£œé½Š)</h3>
    <div class="setup-container">
        <div class="pool-box"><h4>ä¸­è¯éšŠçƒå“¡åå–®</h4><div id="tw-pool"></div></div>
        <div class="pool-box"><h4 style="color:var(--strike);">å…ˆç™¼é™£å®¹</h4><div id="my-lineup-display"></div></div>
    </div>
    <button id="start-btn" onclick="beginGame()">é–‹å§‹å°æ±º</button>
</div>

<div id="game-screen">
    <div id="sub-modal"><h4 id="modal-title">æ›äºº</h4><div id="sub-list"></div><button class="sub-btn" style="width:100%; margin-top:10px;" onclick="closeModal()">å–æ¶ˆ</button></div>
    <div class="line-score">
        <table class="score-table">
            <tr><th>TEAM</th><th>1</th><th>2</th><th>3</th><th>4</th><th>5</th><th>6</th><th>7</th><th>8</th><th>9</th><th>R</th><th>H</th></tr>
            <tr id="row-tpe"><td style="color:var(--accent)">TPE</td><td id="p1">0</td><td id="p2">-</td><td id="p3">-</td><td id="p4">-</td><td id="p5">-</td><td id="p6">-</td><td id="p7">-</td><td id="p8">-</td><td id="p9">-</td><td id="pr">0</td><td id="ph">0</td></tr>
            <tr id="row-jpn"><td style="color:var(--jp-red)">JPN</td><td id="c1">0</td><td id="c2">-</td><td id="c3">-</td><td id="c4">-</td><td id="c5">-</td><td id="c6">-</td><td id="c7">-</td><td id="c8">-</td><td id="c9">-</td><td id="cr">0</td><td id="ch">0</td></tr>
        </table>
    </div>

    <div class="main-layout">
        <div class="order-panel" id="order-ui"><div id="order-list"></div></div>
        <div class="canvas-container">
            <div id="msg-ov" class="overlay" style="position:absolute; font-size:4rem; display:none; z-index:100; color:white;">æ”»å®ˆäº¤æ›</div>
            <div class="feedback-overlay"><div id="speed-text"></div><div id="timing-text"></div><div id="result-text"></div></div>
            <canvas id="fieldCanvas" width="550" height="450"></canvas>
        </div>
        <div class="sidebar">
            <div style="background:#000; padding:12px; border-radius:8px; border:1px solid #444;">
                B <div id="b1" class="light"></div><div id="b2" class="light"></div><div id="b3" class="light"></div><br>
                S <div id="s1" class="light"></div><div id="s2" class="light"></div><br>
                O <div id="o1" class="light"></div><div id="o2" class="light"></div>
                <div id="base-ui" style="margin-top:8px; color:var(--accent); letter-spacing:10px; font-size:1.3rem; text-align:center;">â—‡ â—‡ â—‡</div>
            </div>
            <div id="pitch-ui"><div class="pitch-menu" id="pitch-buttons"></div><button class="sub-btn" style="width:100%;" onclick="openSubModal('P')">ğŸ”„ æ›´æ›æŠ•æ‰‹</button></div>
            <div id="bat-ui" style="display:none;"><button id="swing-btn" onclick="swing()">SWING!</button><button class="sub-btn" style="width:100%;" onclick="openSubModal('B')">ğŸ”„ æ›´æ›ä»£æ‰“</button></div>
            <div id="matchup" style="background:var(--panel); padding:10px; border-radius:5px; border-left:4px solid var(--tw-blue); font-size:0.8rem;"></div>
        </div>
    </div>
</div>

<script>
    const canvas = document.getElementById('fieldCanvas');
    const ctx = canvas.getContext('2d');

    // å®Œæ•´çš„ 15 äººåå–®
    const TW_PLAYERS = [
        { name: "å¾è‹¥ç†™ (2024)", type: "P", speed: 154, ctrl: 90, brk: 98, signature: ["ç«çƒ", "æ¶ˆå¤±æŒ‡å‰", "æ»‘çƒ"] }, 
        { name: "å¤æ—ç¿ç…¬ (2024)", type: "P", speed: 157, ctrl: 95, brk: 88, signature: ["ç«çƒ", "æ»‘çƒ", "è®Šé€Ÿçƒ"] }, 
        { name: "å®‹å®¶è±ª", type: "P", speed: 151, ctrl: 92, brk: 95, signature: ["åœˆæŒ‡è®Šé€Ÿçƒ", "ç«çƒ", "ä¼¸å¡"] }, 
        { name: "å¼µè‚²æˆ", type: "B", avg: .438, pwr: 95, spd: 75 },
        { name: "å‰åŠ›å‰æ’ˆ", type: "B", avg: .310, pwr: 98, spd: 40 },
        { name: "é™³å‚‘æ†²", type: "B", avg: .357, pwr: 65, spd: 92 },
        { name: "æ—ç«‹", type: "B", avg: .333, pwr: 85, spd: 85 },
        { name: "æ±Ÿå¤å®‡", type: "B", avg: .280, pwr: 55, spd: 80 },
        { name: "é„­å®—å“²", type: "B", avg: .333, pwr: 60, spd: 95 },
        { name: "å³å¿µåº­", type: "B", avg: .300, pwr: 75, spd: 65 },
        { name: "ç‹å¨æ™¨", type: "B", avg: .280, pwr: 50, spd: 88 },
        { name: "é™³æ™¨å¨", type: "B", avg: .290, pwr: 55, spd: 99 },
        { name: "æœ±è‚²è³¢", type: "B", avg: .282, pwr: 90, spd: 45 },
        { name: "æ›¾å³»å²³", type: "P", speed: 156, ctrl: 82, brk: 88, signature: ["ç«çƒ", "æ»‘çƒ", "æŒ‡å‰"] },
        { name: "é»ƒå­éµ¬", type: "P", speed: 145, ctrl: 95, brk: 92, signature: ["å´æŠ•ç«çƒ", "äºŒç¸«ç·š", "æ»‘çƒ"] }
    ];

    const JP_ORDER = [
        { name: "Nootbaar", avg: .300, pwr: 80 }, { name: "è¿‘è—¤å¥ä»‹", avg: .340, pwr: 75 }, { name: "å¤§è°·ç¿”å¹³", avg: .435, pwr: 99 },
        { name: "æ‘ä¸Šå®—éš†", avg: .280, pwr: 98 }, { name: "å‰ç”°æ­£å°š", avg: .409, pwr: 85 }, { name: "å²¡æœ¬å’ŒçœŸ", avg: .300, pwr: 90 },
        { name: "å±±ç”°å“²äºº", avg: .250, pwr: 80 }, { name: "æºç”°å£¯äº®", avg: .220, pwr: 50 }, { name: "ä¸­æ‘æ‚ å¹³", avg: .200, pwr: 45 }
    ];
    const JP_PITCHER = { name: "å±±æœ¬ç”±ä¼¸", speed: 158, ctrl: 98, brk: 95, signature: ["æŒ‡å‰çƒ", "ç«çƒ", "å½©è™¹æ›²çƒ"] };

    let myLineup = { B: [], P: null }, dugout = [], state = {
        inning: 1, isTop: true, s: 0, b: 0, o: 0, pScore: 0, cScore: 0, pHits: 0, cHits: 0,
        twIdx: 0, jpIdx: 0, isAnim: false, pitchType: '', pitchFrame: 0,
        bases: [false, false, false], isBallInFlight: false, trail: [], conditions: {} 
    };

    function initSetup() {
        const poolEl = document.getElementById('tw-pool');
        TW_PLAYERS.forEach((p, i) => {
            const div = document.createElement('div'); div.className = 'p-item';
            div.innerHTML = `<span>${p.name}</span> <span>${p.type=='P'?'æŠ•':'æ‰“'}</span>`;
            div.onclick = () => selectPlayer(p, div); poolEl.appendChild(div);
        });
    }

    function selectPlayer(p, el) {
        if (el.classList.contains('selected')) return;
        if (p.type === 'P') { if (myLineup.P) return; myLineup.P = p; }
        else { if (myLineup.B.length >= 9) return; myLineup.B.push(p); }
        el.classList.add('selected');
        document.getElementById('my-lineup-display').innerHTML += `<div class='p-item'>${p.name}</div>`;
        if (myLineup.B.length === 9 && myLineup.P) document.getElementById('start-btn').style.display = 'block';
    }

    function beginGame() {
        const selNames = [...myLineup.B.map(b=>b.name), myLineup.P.name];
        dugout = TW_PLAYERS.filter(p => !selNames.includes(p.name));
        document.getElementById('setup-screen').style.display = 'none';
        document.getElementById('game-screen').style.display = 'flex';
        updatePitchMenu(); updateOrderUI(); updateUI(); render();
        if (!state.isTop) setTimeout(cpuPitch, 1000);
    }

    function openSubModal(type) {
        const modal = document.getElementById('sub-modal'), list = document.getElementById('sub-list');
        list.innerHTML = '';
        dugout.filter(p => p.type === type).forEach(p => {
            const div = document.createElement('div'); div.className = 'sub-item';
            div.innerHTML = `<span>${p.name}</span> <span>${type=='P'?'V:'+p.speed:'SUB'}</span>`;
            div.onclick = () => {
                if(type === 'P') { myLineup.P = p; updatePitchMenu(); } else { myLineup.B[state.twIdx] = p; updateOrderUI(); }
                dugout = dugout.filter(x => x.name !== p.name); closeModal(); updateUI();
            }; list.appendChild(div);
        }); modal.style.display = 'block';
    }

    function closeModal() { document.getElementById('sub-modal').style.display = 'none'; }

    function updatePitchMenu() {
        const menu = document.getElementById('pitch-buttons'); menu.innerHTML = '';
        const currP = state.isTop ? myLineup.P : JP_PITCHER;
        currP.signature.forEach((s, i) => {
            const btn = document.createElement('button'); btn.className = `btn ${i === 0 ? 'active' : ''}`; btn.innerText = s;
            if (i === 0) state.pitchType = s;
            btn.onclick = () => { state.pitchType = s; document.querySelectorAll('.pitch-menu .btn').forEach(b => b.classList.remove('active')); btn.classList.add('active'); };
            menu.appendChild(btn);
        });
    }

    function updateOrderUI() {
        const list = document.getElementById('order-list'), order = state.isTop ? JP_ORDER : myLineup.B, idx = state.isTop ? state.jpIdx : state.twIdx;
        list.innerHTML = ''; 
        order.forEach((p, i) => {
            const div = document.createElement('div'); div.className = `order-item ${i === idx ? 'active' : ''}`;
            div.innerHTML = `<span>${i+1}. ${p.name}</span>`; list.appendChild(div);
        });
    }

    function render(f = 0) {
        ctx.clearRect(0,0,550,450); ctx.strokeStyle = "rgba(0, 242, 255, 0.2)"; ctx.strokeRect(175, 100, 200, 200);
        for(let i=1; i<3; i++) {
            ctx.beginPath(); ctx.moveTo(175+i*66.6, 100); ctx.lineTo(175+i*66.6, 300);
            ctx.moveTo(175, 100+i*66.6); ctx.lineTo(375, 100+i*66.6); ctx.stroke();
        }
        if (state.trail.length > 1) {
            ctx.beginPath(); ctx.strokeStyle = "rgba(255,255,255,0.3)"; ctx.lineWidth = 1.5;
            ctx.moveTo(state.trail[0].x, state.trail[0].y);
            for(let i=1; i<state.trail.length; i++) ctx.lineTo(state.trail[i].x, state.trail[i].y); ctx.stroke();
        }
        let leg = (f > 0 && f < 12) ? -35 : 0;
        ctx.strokeStyle = "#fff"; ctx.lineWidth = 4;
        ctx.beginPath(); ctx.arc(275, 360, 12, 0, Math.PI*2); ctx.stroke();
        ctx.moveTo(275, 372); ctx.lineTo(275, 410); ctx.moveTo(275, 410); ctx.lineTo(260, 445);
        ctx.moveTo(275, 410); ctx.lineTo(290, 445+leg); ctx.stroke();
    }

    canvas.addEventListener('mousedown', (e) => {
        if (state.isAnim || !state.isTop) return;
        const rect = canvas.getBoundingClientRect(); startPitch(e.clientX - rect.left, e.clientY - rect.top);
    });

    function startPitch(tx, ty) {
        state.isAnim = true; state.trail = []; let f = 0;
        const anim = () => {
            f++; render(f); if(f < 18) requestAnimationFrame(anim);
            else {
                let bf = 0; const p = state.isTop ? myLineup.P : JP_PITCHER;
                let sB = p.speed;
                if (state.pitchType.includes("è®Šé€Ÿ") || state.pitchType.includes("æŒ‡å‰")) sB -= 12;
                const spd = Math.floor(sB + (Math.random()*4-2));
                document.getElementById('speed-text').innerText = spd + " km/h";
                document.getElementById('speed-text').style.display = 'block';

                const fly = () => {
                    bf++; state.pitchFrame = bf; state.isBallInFlight = true;
                    let pVal = bf/22; render(18);
                    let ballSize = 2 + (pVal * 18); 
                    let cF = pVal > 0.4 ? Math.pow(pVal - 0.4, 2) * 5 : 0;
                    let dx = 0, dy = 0;
                    
                    if(state.pitchType.includes("æ»‘çƒ")) dx = cF * -65; 
                    if(state.pitchType.includes("æ›²çƒ")) { dx = cF * -55; dy = cF * 55; }
                    
                    // é­”çƒä¿®æ­£é‚è¼¯ï¼šè¨ˆç®—è£œå„Ÿï¼Œä½¿æœ€çµ‚é€²å£˜é»å‰›å¥½åœ¨ ty
                    if(state.pitchType === "æ¶ˆå¤±æŒ‡å‰" || state.pitchType === "åœˆæŒ‡è®Šé€Ÿçƒ") {
                        dy = cF * 190; 
                        if(state.pitchType === "åœˆæŒ‡è®Šé€Ÿçƒ") dx = cF * 45;
                        else dx = cF * -25;
                    }
                    
                    // è¦–è¦ºYè»¸ï¼šæ¨¡æ“¬ã€Œé£›é«˜å¾Œæ‰è½ã€
                    let visualY = (370 + (ty - dy - 370) * pVal) + dy * Math.pow(pVal, 2);
                    let cx = 275 + (tx-275)*pVal + dx;

                    state.trail.push({x: cx, y: visualY});
                    ctx.beginPath(); ctx.arc(cx, visualY, ballSize, 0, Math.PI*2); ctx.fillStyle = "#fff"; ctx.fill();
                    if(bf < 22) requestAnimationFrame(fly); else resolve(cx, visualY);
                }; fly();
            }
        }; anim();
    }

    function resolve(cx, cy) {
        state.isAnim = false; state.isBallInFlight = false;
        let inZone = cx > 175 && cx < 375 && cy > 100 && cy < 300;
        let batter = state.isTop ? JP_ORDER[state.jpIdx] : myLineup.B[state.twIdx];
        if (state.isTop) {
            if (inZone && Math.random() < batter.avg) {
                const q = Math.random() < (batter.pwr/160) ? 2 : 1;
                showFeedback("", q === 2 ? "JPN é•·æ‰“ï¼" : "JPN å®‰æ‰“ï¼"); handleHit(q);
            } else if (inZone) { state.s++; if (state.s >= 3) { state.o++; state.s=0; state.b=0; showFeedback("", "ä¸‰æŒ¯ï¼"); finishPA(); } }
            else { state.b++; if (state.b >= 4) handleWalk(); }
        } else {
            if (inZone) state.s++; else state.b++;
            if (state.s >= 3) { state.o++; state.s=0; state.b=0; showFeedback("", "ä¸‰æŒ¯ï¼"); finishPA(); }
            if (state.b >= 4) handleWalk();
        }
        checkInning(); updateUI();
    }

    function swing() {
        if (!state.isBallInFlight) return;
        state.isBallInFlight = false;
        let timing = "TOO LATE", batter = myLineup.B[state.twIdx];
        if (state.pitchFrame >= 19 && state.pitchFrame <= 21) timing = "PERFECT";
        else if (state.pitchFrame >= 15 && state.pitchFrame <= 22) timing = "GOOD";
        if (timing === "PERFECT") {
            const isHR = Math.random() < (batter.pwr / 180);
            handleHit(isHR ? 4 : 2); showFeedback("PERFECT", isHR ? "å…¨å£˜æ‰“ï¼" : "é•·æ‰“ï¼");
        } else if (timing === "GOOD" && Math.random() < batter.avg) {
            handleHit(1); showFeedback("GOOD", "å®‰æ‰“ï¼");
        } else {
            state.s++; showFeedback(timing, "æ®æ£’è½ç©º");
            if (state.s >= 3) { state.o++; state.s=0; state.b=0; showFeedback("", "ä¸‰æŒ¯ï¼"); finishPA(); }
        }
        checkInning(); updateUI();
    }

    function handleHit(bases) {
        let r = 0; if(bases === 4) { r = state.bases.filter(b=>b).length + 1; state.bases = [false, false, false]; }
        else { for (let i = 2; i >= 0; i--) { if (state.bases[i]) { if (i + bases >= 3) { r++; state.bases[i] = false; } else { state.bases[i + bases] = true; state.bases[i] = false; } } } state.bases[bases - 1] = true; }
        if (state.isTop) state.cScore += r; else state.pScore += r;
        state.s = 0; state.b = 0; finishPA();
    }

    function handleWalk() { 
        let r = 0; if (state.bases[0] && state.bases[1] && state.bases[2]) r = 1; else if (state.bases[0] && state.bases[1]) state.bases[2] = true; else if (state.bases[0]) state.bases[1] = true;
        state.bases[0] = true; if (state.isTop) state.cScore += r; else state.pScore += r;
        state.s = 0; state.b = 0; finishPA(); 
    }

    function finishPA() { if (state.isTop) state.jpIdx = (state.jpIdx + 1) % JP_ORDER.length; else state.twIdx = (state.twIdx + 1) % 9; updateOrderUI(); }

    function checkInning() {
        if (state.o >= 3) {
            state.o = 0; state.s = 0; state.b = 0; state.bases = [false, false, false]; state.isTop = !state.isTop; if (state.isTop) state.inning++;
            const ov = document.getElementById('msg-ov'); ov.style.display = 'block'; setTimeout(()=>ov.style.display='none', 1500);
            updateOrderUI(); updatePitchMenu();
        }
        document.getElementById('pitch-ui').style.display = state.isTop ? 'block' : 'none';
        document.getElementById('bat-ui').style.display = state.isTop ? 'none' : 'block';
        if (!state.isTop && !state.isAnim && !state.isBallInFlight) setTimeout(cpuPitch, 2000);
    }

    function cpuPitch() { if (state.isTop) return; state.pitchType = JP_PITCHER.signature[Math.floor(Math.random()*JP_PITCHER.signature.length)]; startPitch(200+Math.random()*150, 120+Math.random()*150); }

    function showFeedback(timing, result) {
        const t = document.getElementById('timing-text'), r = document.getElementById('result-text'), s = document.getElementById('speed-text');
        t.innerText = timing; r.innerText = result; t.style.display = timing ? 'block' : 'none'; r.style.display = 'block';
        setTimeout(() => { t.style.display = 'none'; r.style.display = 'none'; s.style.display = 'none'; }, 1500);
    }

    function updateUI() {
        document.getElementById('pr').innerText = state.pScore; document.getElementById('cr').innerText = state.cScore;
        const curId = state.isTop ? `c${state.inning}` : `p${state.inning}`; if(document.getElementById(curId)) document.getElementById(curId).innerText = state.isTop ? state.cScore : state.pScore;
        document.getElementById('s1').className = state.s >= 1 ? 'light s-on' : 'light'; document.getElementById('s2').className = state.s >= 2 ? 'light s-on' : 'light';
        document.getElementById('b1').className = state.b >= 1 ? 'light b-on' : 'light'; document.getElementById('b2').className = state.b >= 2 ? 'light b-on' : 'light'; document.getElementById('b3').className = state.b >= 3 ? 'light b-on' : 'light';
        document.getElementById('o1').className = state.o >= 1 ? 'light o-on' : 'light'; document.getElementById('o2').className = state.o >= 2 ? 'light o-on' : 'light';
        document.getElementById('base-ui').innerText = state.bases.map(b => b ? "â—†" : "â—‡").join(" ");
        const p = state.isTop ? myLineup.P : JP_PITCHER, b = state.isTop ? JP_ORDER[state.jpIdx] : myLineup.B[state.twIdx];
        document.getElementById('matchup').innerText = `${p.name} vs ${b.name}`;
    }

    initSetup();
</script>
</body>
</html>
