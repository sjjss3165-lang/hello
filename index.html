<!DOCTYPE html>
<html lang="zh-Hant">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>é›»æ©Ÿç§‘å°ˆå±¬é»é¤ç³»çµ±ğŸ‘©ğŸ¼â€ğŸ³</title>
    <style>
        :root {
            --primary: #2c3e50;
            --bg: #f8f9fa;
            --card: #ffffff;
            --accent: #e67e22;
            --open: #27ae60;
            --closed: #c0392b;
            --hot: #f1c40f;
        }

        body {
            font-family: "PingFang TC", "Microsoft JhengHei", sans-serif;
            background-color: var(--bg);
            margin: 0;
            padding: 0;
            color: #333;
        }

        header {
            background: #fff;
            padding: 2rem 1rem;
            text-align: center;
            border-bottom: 1px solid #ddd;
            position: sticky;
            top: 0;
            z-index: 1000;
        }

        .tool-bar {
            background: var(--primary);
            padding: 15px;
            display: flex;
            justify-content: center;
            gap: 10px;
            flex-wrap: wrap;
        }

        .btn-tool {
            background: var(--accent);
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 20px;
            cursor: pointer;
            font-weight: bold;
            transition: 0.3s;
        }

        /* è½‰ç›¤æ¨£å¼ */
        #wheel-container {
            display: none;
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            z-index: 2000;
            background: white;
            padding: 30px;
            border-radius: 20px;
            box-shadow: 0 0 50px rgba(0,0,0,0.5);
            text-align: center;
        }
        #wheel {
            width: 300px;
            height: 300px;
            border-radius: 50%;
            border: 10px solid var(--primary);
            transition: transform 4s cubic-bezier(0.15, 0, 0.15, 1);
            margin: 20px auto;
            position: relative;
            overflow: hidden;
        }
        .wheel-pointer {
            width: 0; height: 0;
            border-left: 15px solid transparent;
            border-right: 15px solid transparent;
            border-top: 30px solid red;
            position: absolute;
            top: -10px; left: 50%;
            transform: translateX(-50%);
            z-index: 2001;
        }

        .container { max-width: 1000px; margin: 20px auto; padding: 0 15px; }
        .grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(300px, 1fr)); gap: 20px; }
        
        .card {
            background: var(--card);
            padding: 20px;
            border-radius: 12px;
            box-shadow: 0 4px 6px rgba(0,0,0,0.05);
            display: flex;
            flex-direction: column;
            position: relative;
        }
        .status-badge { position: absolute; top: 15px; right: 15px; padding: 4px 8px; border-radius: 4px; font-size: 0.75rem; font-weight: bold; color: white; }
        .hot-badge { position: absolute; top: -10px; left: 10px; background: var(--hot); color: #333; padding: 4px 10px; border-radius: 20px; font-size: 0.8rem; font-weight: bold; }
        .open { background: var(--open); }
        .closed { background: var(--closed); }

        .order-system { background: white; padding: 25px; border-radius: 12px; margin-top: 30px; box-shadow: 0 4px 15px rgba(0,0,0,0.1); border: 2px solid var(--accent); }
        .order-system h2 { color: var(--accent); margin-top: 0; }
        .target-store-display { background: #fff3e0; padding: 10px; border-radius: 8px; margin-bottom: 15px; font-weight: bold; border: 1px dashed var(--accent); }

        table { width: 100%; border-collapse: collapse; margin-top: 10px; }
        th, td { border: 1px solid #ddd; padding: 12px; text-align: center; }
        th { background: #f8f9fa; }
        input { width: 90%; padding: 8px; border: 1px solid #ccc; border-radius: 4px; }
        
        .total-area { text-align: right; font-size: 1.4rem; font-weight: bold; color: var(--accent); margin-top: 20px; }
        .overlay { display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.7); z-index: 1999; }
    </style>
</head>
<body>

<header>
    <h1>é›»æ©Ÿç§‘å°ˆå±¬é»é¤ç³»çµ±ğŸ‘©ğŸ¼â€ğŸ³</h1>
</header>

<div class="tool-bar">
    <button class="btn-tool" onclick="showWheel()">ğŸ¡ éš¨æ©Ÿè½‰ç›¤æŠ½ç±¤</button>
    <button class="btn-tool" style="background:#f1c40f; color:#333;" onclick="filterHot()">ğŸ”¥ ç†±é–€åº—å®¶</button>
    <button class="btn-tool" style="background:#7f8c8d" onclick="renderStores()">ğŸ”„ é¡¯ç¤ºå…¨éƒ¨</button>
</div>

<div class="overlay" id="overlay" onclick="closeWheel()"></div>
<div id="wheel-container">
    <h2>ğŸ¡ å‘½é‹è½‰ç›¤</h2>
    <div class="wheel-pointer"></div>
    <div id="wheel"></div>
    <button class="btn-tool" id="spin-btn" onclick="spinWheel()" style="margin-top:20px; width:100%;">é–‹å§‹æ—‹è½‰ï¼</button>
    <p id="wheel-result" style="margin-top:15px; font-weight:bold; color:var(--accent);"></p>
</div>

<div class="container">
    <section id="drinks">
        <h2>ğŸ¥¤ é£²æ–™åº—</h2>
        <div id="drinks-grid" class="grid"></div>
    </section>

    <section id="food">
        <h2>ğŸœ åœ¨åœ°ç¾é£Ÿ</h2>
        <div id="food-grid" class="grid"></div>
    </section>

    <section id="order-tool">
        <div class="order-system">
            <h2>ğŸ“ ç­ç´šé»é¤çµ±è¨ˆå™¨</h2>
            <div class="target-store-display">
                æ­£åœ¨çµ±è¨ˆï¼š<span id="current-ordering-store">å°šæœªé¸æ“‡åº—å®¶ (é»æ“Šä¸Šæ–¹ã€ŒæŸ¥çœ‹èœå–®ã€æœƒè‡ªå‹•è¨­å®š)</span>
            </div>
            <table id="orderTable">
                <thead>
                    <tr>
                        <th width="20%">å§“å</th>
                        <th width="40%">å“é … (å«ç³–å†°/å‚™è¨»)</th>
                        <th width="20%">é‡‘é¡</th>
                        <th width="20%">æ“ä½œ</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td><input type="text" placeholder="ä¾‹: 1è™Ÿ æŸæŸæŸ"></td>
                        <td><input type="text" placeholder="ä¾‹: ç‰›è‚‰éºµ å¤§è¾£"></td>
                        <td><input type="number" class="price-input" oninput="calculateTotal()" placeholder="0"></td>
                        <td><button onclick="removeRow(this)">âŒ</button></td>
                    </tr>
                </tbody>
            </table>
            <div style="margin-top:15px; display:flex; gap:10px;">
                <button onclick="addRow()" class="btn-tool" style="background:#27ae60;">â• æ–°å¢å§“å</button>
                <button onclick="window.print()" class="btn-tool" style="background:#2980b9;">ğŸ–¨ï¸ åˆ—å°/å„²å­˜PDF</button>
            </div>
            <div class="total-area">é›»æ©Ÿç§‘ç¸½è¨ˆé‡‘é¡ï¼š$<span id="totalPrice">0</span></div>
        </div>
    </section>
</div>

<script>
const stores = [
    { name: "æ¸…å¿ƒ åŸºéš†æµ·å¤§åº—", tel: "0224626266", menu: "http://chingshin.tw/", category: "drink", isHot: false, hours: { all: ["11:00", "22:45"] } },
    { name: "å¯ä¸å¯ åŸºéš†æ·±æºªåº—", tel: "0224659695", menu: "https://www.kebuke.com/", category: "drink", isHot: true, hours: { all: ["10:00", "22:00"] } },
    { name: "50åµ åŸºéš†æ·±æºªåº—", tel: "0224683368", menu: "https://order.nidin.shop/menu/21216", category: "drink", isHot: true, hours: { all: ["10:00", "22:00"] } },
    { name: "é¾œè¨˜ åŸºéš†åº—", tel: "0224258889", menu: "https://guiji.doteat.tw/menu?storeId=LEzDQINl-0000wKv98o&showBulletin=1", category: "drink", isHot: false, hours: { all: ["11:00", "22:00"] } },
    { name: "è¿·å®¢å¤ åŸºéš†å»Ÿå£åº—", tel: "0224261766", menu: "https://milksha.nidin.shop/menu/491", category: "drink", isHot: false, hours: { all: ["10:00", "21:00"] } },
    { name: "äº”æ¡è™Ÿ åŸºéš†ä»ä¸‰åº—", tel: "0224283616", menu: "https://www.wootea.com/menu/", category: "drink", isHot: true, hours: { 1: null, 2: ["11:00", "20:00"], 0: ["11:00", "20:00"] } },
    { name: "å¾—æ­£ #åŸºéš†æµ·å¤§", tel: "0224621016", menu: "https://order.nidin.shop/menu/18739", category: "drink", isHot: true, hours: { all: ["10:30", "21:30"] } },
    { name: "æ‹¾æ±£èŒ¶å±‹ åŸºéš†å»Ÿå£åº—", tel: "0224247778", menu: "https://www.19teahouse.com/works/detail/Store29", category: "drink", isHot: true, hours: { all: ["10:30", "21:00"] } },
    { name: "è’Ÿè’»å±‹", tel: "0224229000", menu: "https://drive.google.com/file/d/1T08WgpxufhYVOJ8sbfc7gvpthvoDaacY/view?usp=sharing", category: "food", isHot: true, hours: { all: ["09:00", "02:00"] } },
    { name: "å¤§ç¢—ç‰›è‚‰éºµ", tel: "0224633396", menu: "https://drive.google.com/file/d/12wii4UGfDTHYECO5ObXyS6qutY9qRcaX/view?usp=sharing", category: "food", isHot: true, hours: { all: ["11:00", "20:00"] } },
    { name: "é‚±è¨˜ç‚’éºµï¼ˆæ±ä¿¡åº—ï¼‰", tel: "0224680335", menu: "https://drive.google.com/file/d/1zuEI_w-zwS9rIGRcekHsb_QXll1twyg3/view?usp=sharing", category: "food", isHot: true, hours: { 1: ["11:00", "20:00"], 6: null } },
    { name: "å»–åª½åª½éºµé£¯é¤¨-æ–°è±åº—", tel: "0224680789", menu: "https://drive.google.com/file/d/1j_SjavYZbnJjJHCJNSzVQaAzf_1e5Km0/view?usp=sharing", category: "food", isHot: true, hours: { 1: ["11:00", "21:00"], 0: null } }
];

// åˆå§‹åŒ–åº—å®¶å¡ç‰‡
function renderStores(filterHot = false) {
    const dGrid = document.getElementById('drinks-grid');
    const fGrid = document.getElementById('food-grid');
    dGrid.innerHTML = ''; fGrid.innerHTML = '';

    stores.forEach(s => {
        if (filterHot && !s.isHot) return;
        const info = checkStatus(s);
        const card = `
            <div class="card" id="${s.name}">
                ${s.isHot ? '<span class="hot-badge">ğŸ”¥ é›»æ©Ÿç†±é–€</span>' : ''}
                <span class="status-badge ${info.class}">${info.status}</span>
                <h3>${s.name}</h3>
                <div class="info">ğŸ“ ${s.tel}<br>â° ${info.msg}</div>
                <div class="actions">
                    <a href="tel:${s.tel}" class="btn btn-call">æ’¥æ‰“</a>
                    <a href="${s.menu}" target="_blank" class="btn btn-menu" onclick="setOrderingStore('${s.name}')">èœå–®/è¨­å®šçµ±è¨ˆ</a>
                </div>
            </div>
        `;
        if (s.category === 'drink') dGrid.innerHTML += card;
        else fGrid.innerHTML += card;
    });
}

function setOrderingStore(name) {
    document.getElementById('current-ordering-store').innerText = name;
    document.getElementById('order-tool').scrollIntoView({ behavior: 'smooth' });
}

// ç‡Ÿæ¥­ç‹€æ…‹æª¢æŸ¥
function checkStatus(s) {
    const now = new Date();
    const day = now.getDay();
    const curr = now.getHours() * 60 + now.getMinutes();
    let range = s.hours.all || s.hours[day];
    if (!range) return { status: "å·²æ‰“çƒŠ", class: "closed", msg: "ä»Šå¤©å…¬ä¼‘" };
    const [sH, sM] = range[0].split(":").map(Number);
    const [eH, eM] = range[1].split(":").map(Number);
    let sT = sH * 60 + sM, eT = eH * 60 + eM;
    if (eT < sT) { // è·¨å¤œ
        if (curr >= sT || curr < eT) return { status: "ç‡Ÿæ¥­ä¸­", class: "open", msg: "æ·±å¤œæ™‚æ®µ" };
    } else if (curr >= sT && curr < eT) {
        return { status: "ç‡Ÿæ¥­ä¸­", class: "open", msg: "ç¾åœ¨æœ‰é–‹" };
    }
    return { status: "å·²æ‰“çƒŠ", class: "closed", msg: "ç›®å‰ä¼‘æ¯ä¸­" };
}

// è½‰ç›¤åŠŸèƒ½
function showWheel() {
    document.getElementById('overlay').style.display = 'block';
    document.getElementById('wheel-container').style.display = 'block';
    const wheel = document.getElementById('wheel');
    wheel.innerHTML = '';
    const colors = ['#f1c40f', '#e67e22', '#e74c3c', '#9b59b6', '#3498db', '#2ecc71'];
    stores.forEach((s, i) => {
        const segment = document.createElement('div');
        segment.style.position = 'absolute';
        segment.style.width = '100%';
        segment.style.height = '100%';
        segment.style.background = colors[i % colors.length];
        segment.style.clipPath = `polygon(50% 50%, 50% 0%, ${50 + 50 * Math.tan(Math.PI / stores.length)}% 0%)`;
        segment.style.transform = `rotate(${(360 / stores.length) * i}deg)`;
        wheel.appendChild(segment);
    });
}

function spinWheel() {
    const btn = document.getElementById('spin-btn');
    btn.disabled = true;
    const wheel = document.getElementById('wheel');
    const randomDeg = Math.floor(Math.random() * 360) + 3600; // è½‰è‡³å°‘10åœˆ
    wheel.style.transform = `rotate(${randomDeg}deg)`;
    
    setTimeout(() => {
        const actualDeg = randomDeg % 360;
        const index = Math.floor((360 - actualDeg) / (360 / stores.length)) % stores.length;
        const result = stores[index];
        document.getElementById('wheel-result').innerText = `ğŸ‰ æŠ½ä¸­äº†ï¼š${result.name}ï¼`;
        btn.disabled = false;
        setTimeout(() => {
            closeWheel();
            setOrderingStore(result.name);
        }, 1500);
    }, 4000);
}

function closeWheel() {
    document.getElementById('overlay').style.display = 'none';
    document.getElementById('wheel-container').style.display = 'none';
}

// çµ±è¨ˆå™¨åŠŸèƒ½
function addRow() {
    const tbody = document.querySelector("#orderTable tbody");
    const tr = document.createElement('tr');
    tr.innerHTML = `<td><input type="text"></td><td><input type="text"></td><td><input type="number" class="price-input" oninput="calculateTotal()"></td><td><button onclick="removeRow(this)">âŒ</button></td>`;
    tbody.appendChild(tr);
}
function removeRow(b) { b.closest('tr').remove(); calculateTotal(); }
function calculateTotal() {
    let total = 0;
    document.querySelectorAll(".price-input").forEach(i => total += (Number(i.value) || 0));
    document.getElementById("totalPrice").innerText = total;
}

function filterHot() { renderStores(true); }

window.onload = () => renderStores();
</script>
</body>
</html>
