<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Èõª‰∏âÂ≠ùÊô∫ÊÖßÁÆ°ÁêÜÁ≥ªÁµ± v31</title>
    <style>
        :root {
            --primary: #00d4ff; --accent: #f72585; --warning: #ffb703;
            --bg-dark: #0b0f19; --glass: rgba(255, 255, 255, 0.05); --border: rgba(255, 255, 255, 0.1);
        }
        body {
            margin: 0; background: radial-gradient(circle at center, #1a1f35 0%, #0b0f19 100%);
            color: #e2e8f0; font-family: 'SF Pro Display', 'Microsoft JhengHei', sans-serif;
            display: flex; flex-direction: column; align-items: center; min-height: 100vh; padding-bottom: 50px;
        }
        .dashboard {
            width: 95%; max-width: 800px; background: var(--glass); backdrop-filter: blur(20px);
            border: 1px solid var(--border); border-radius: 24px; padding: 25px;
            box-shadow: 0 40px 100px rgba(0,0,0,0.5); margin: 20px 0;
        }
        #clock { font-size: 3.2rem; font-weight: 200; color: var(--primary); text-align: center; margin-bottom: 5px; }
        
        .info-panel { 
            background: rgba(0,0,0,0.4); border-radius: 12px; padding: 15px; margin: 20px 0; 
            border: 1px solid var(--border); display: flex; justify-content: space-around; align-items: center;
        }
        .info-item { text-align: center; flex: 1; }
        .info-label { font-size: 0.65rem; color: #94a3b8; letter-spacing: 1px; margin-bottom: 5px; }
        .info-value { font-size: 1.2rem; font-weight: bold; color: #fff; }

        .late-list-box {
            background: rgba(255, 183, 3, 0.05); border: 1px dashed var(--warning);
            border-radius: 12px; padding: 15px; margin-top: 20px;
        }
        .late-list-content { color: var(--warning); font-family: monospace; font-size: 0.9rem; word-break: break-all; }

        .seating-chart { display: grid; grid-template-columns: repeat(7, 1fr); gap: 8px; margin-top: 20px; }
        .seat {
            aspect-ratio: 1.1; background: rgba(255,255,255,0.03); border: 1px solid var(--border);
            border-radius: 8px; display: flex; flex-direction: column; align-items: center;
            justify-content: center; cursor: pointer; transition: 0.2s; position: relative; padding: 2px;
        }
        .seat.present { background: rgba(0, 212, 255, 0.12); border-color: var(--primary); }
        .seat.absent { background: rgba(247, 37, 133, 0.25); border-color: var(--accent); }
        .seat.late { background: rgba(255, 183, 3, 0.25); border-color: var(--warning); }
        .seat-no { font-size: 0.55rem; position: absolute; top: 4px; left: 6px; opacity: 0.6; }
        .seat-name { font-size: 0.85rem; font-weight: bold; }

        .teacher-desk { grid-column: span 7; background: rgba(255,255,255,0.1); height: 40px; margin-bottom: 50px; margin-top: 40px; border-radius: 6px; display: flex; align-items: center; justify-content: center; font-size: 0.8rem; letter-spacing: 8px; color: #94a3b8; border: 1px dashed var(--border); position: relative;}
        .special-seat { position: absolute; top: -50px; width: 55px; height: 40px; background: rgba(0,212,255,0.1); border: 1px solid var(--primary); border-radius: 8px; display: flex; align-items: center; justify-content: center; cursor: pointer;}

        .btn { width: auto; padding: 8px 20px; border-radius: 12px; border: none; font-weight: bold; cursor: pointer; margin-top: 30px; display: block; margin-left: auto; margin-right: auto; }
        .btn-primary { background: var(--primary); color: #000; opacity: 0.4; font-size: 0.7rem; }

        #login-wall { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: var(--bg-dark); display: flex; justify-content: center; align-items: center; z-index: 999; }
        input[type="password"] { width: 200px; padding: 10px; border-radius: 8px; border: 1px solid var(--border); background: rgba(0,0,0,0.3); color: white; text-align: center; }
    </style>
</head>
<body>

    <div id="login-wall">
        <div class="dashboard" style="max-width: 300px; text-align:center;">
            <h3 style="color:var(--primary)">Èõª‰∏âÂ≠ùÁÆ°ÁêÜÁ≥ªÁµ±</h3>
            <input type="password" id="pass" placeholder="Password">
            <button class="btn btn-primary" style="opacity:1; font-size:1rem; margin-top:15px;" onclick="doLogin()">UNLOCK</button>
        </div>
    </div>

    <div id="main-content" style="display: none; width: 100%; align-items: center; flex-direction: column;">
        <div class="dashboard">
            <div id="clock">00:00:00</div>
            
            <div class="info-panel">
                <div class="info-item" style="border-right: 1px solid var(--border);">
                    <div class="info-label">ÁõÆÂâçË™≤Á®ã</div>
                    <div id="current-lesson" class="info-value">--</div>
                </div>
                <div class="info-item">
                    <div class="info-label">‰∏ãË™≤ÂÄíÊï∏</div>
                    <div id="timer" class="info-value">--</div>
                </div>
            </div>

            <div class="late-list-box" id="late-box" style="display:none;">
                <div class="info-label" style="color:var(--warning); margin-bottom:10px;">üìã ÈÅ≤Âà∞ÁôªË®òÂêçÂñÆ</div>
                <div id="late-text" class="late-list-content"></div>
            </div>

            <div style="display:flex; justify-content:space-between; align-items:center; margin: 20px 0 10px; border-bottom: 1px solid var(--border); padding-bottom: 10px;">
                <span style="font-size:0.75rem; color:var(--primary); letter-spacing:2px; font-weight: bold;">SEATING PLAN</span>
                <div style="font-size:0.8rem;">
                    Âá∫: <b id="p-count" style="color:var(--primary)">0</b> | 
                    Áº∫: <b id="a-count" style="color:var(--accent)">0</b> | 
                    ÈÅ≤: <b id="l-count" style="color:var(--warning)">0</b>
                </div>
            </div>

            <div class="seating-chart" id="chart">
                <div class="teacher-desk">
                    Ë¨õÊ°å / BLACKBOARD
                    <div class="special-seat" style="left: 20%;" id="s-13" onclick="toggleSeat(13)"><span style="font-size:0.65rem;">13</span></div>
                    <div class="special-seat" style="left: 45%;" id="s-41" onclick="toggleSeat(41)"><span style="font-size:0.65rem;">41</span></div>
                </div>
            </div>
            
            <button class="btn btn-primary" onclick="resetSeats()">RESET ALL SEATS</button>
        </div>
    </div>

    <script>
        const AUTH = "1234";
        const students = {"1":"ÊûóÊπòÂáå","2":"ÈÇ±Â©âÁê≥","3":"Èß±Êò±ÂΩ£","4":"ÊñΩÈõÖÁëÑ","5":"È†ÖÁùøÂª∑","6":"ÊùúÊüèÊòÇ","7":"Èô≥ÂøóÂÄ´","8":"È°èÈäòÂæµ","9":"ÊûóÂ∞öÂª∑","10":"ÂæêÂæóËªí","11":"Ëî°‰∏ûÊÅ©","12":"ÈÇ±ÂÆ•Áùø","13":"Áü≥Êµ©Êñá","14":"ÁéãÂìÅÂ†Ø","15":"Âë®Ëæ∞Êó≠","16":"ÁéãÊ∑ÆË¨ô","17":"ÊûóÊòìÊæÑ","18":"ÈªÉÂ≠òË±™","19":"Êü≥Âá±Âçö","20":"Â≠´Ê≤ÇÈàû","21":"È¶ÆÈùñÂØå","22":"Èô≥‰ΩëÁëú","23":"ÊñΩÈÇ¶‰Ωë","24":"ËåÉËàúÁÇ∫","25":"Ë®±ÁøîÁ°Ø","26":"Èô≥Êï¨ÊÅ©","27":"Èô≥Â≠∏Ê¥ã","28":"Ê±üÈÉÅÊòå","29":"ÈÑ≠ÈñéÊ•∑","30":"Ê±üÊâøÊÅ©","31":"Ê¥™ÁïØÊ•∑","32":"ÈÑ≠ËÅøÂª∑","33":"‰ΩïÊâøÊÅ©","34":"ÂºµË≠∞Êæß","35":"Ëî°ÂìÅÂÆá","36":"ÊõæÊüèË´∫","37":"Ë©πË©†ÂÖ®","38":"ÊñπÂª∑Á•ê","39":"Èô≥ÂÇ≥Âè°","40":"Âë®ÂΩ•Êàê","41":"Âê≥ÊüèË´∫"};
        
        const seatMapping = [
            2, 0, 0, 6, 20, 10, 21,
            12, 23, 25, 34, 3, 1, 33,
            39, 4, 19, 15, 18, 24, 30,
            40, 5, 16, 35, 29, 9, 36,
            32, 14, 37, 17, 31, 8, 7,
            22, 11, 26, 38, 0, 0, 0
        ];

        const schedule = {
            1: ["ÂúãÊñá", "Ëã±Ë™ûÊúÉË©±", "Ëã±Ë™ûÊñá", "ÈÄ≤ÈöéÊï∏Â≠∏", "ÊáâÈõªÂä©Êïô", "ÊáâÈõªÂä©Êïô", "ÊáâÈõªÂä©Êïô", "ÂΩàÊÄß"],
            2: ["È´îËÇ≤", "ÈõªÊ©ü‰∏ª‰ªª", "ÈõªÊ©ü‰∏ª‰ªª", "Èñ±ËÆÄËÄÅÂ∏´", "‰ºëÊÅØ", "Êï∏Â≠∏ËÄÅÂ∏´", "‰ºëÊÅØ", "Ë™≤Ëºî"],
            3: ["ÂØ¶Áøí‰∏ª‰ªª", "ÂØ¶Áøí‰∏ª‰ªª", "ÂØ¶Áøí‰∏ª‰ªª", "Ëã±Ë™ûÊúÉË©±", "ÂæÆÈõªÂä©Êïô", "ÂæÆÈõªÂä©Êïô", "ÂúãÊñá", "ÂΩàÊÄß"],
            4: ["Êï∏ÈÇèÂä©Êïô", "Êï∏ÈÇèÂä©Êïô", "Êï∏ÈÇèÂä©Êïô", "Êï∏Â≠∏ËÄÅÂ∏´", "Â∞àÈ°åÂä©Êïô", "Â∞àÈ°åÂä©Êïô", "Â∞àÈ°åÂä©Êïô", "Ëá™‰∏ª"],
            5: ["Ëã±Ë™ûÊñá", "ÈõªÂäõÂä©Êïô", "ÈõªÂäõÂä©Êïô", "ÈõªÂäõÂä©Êïô", "È´îËÇ≤", "Èñ±ËÆÄËÄÅÂ∏´", "ÈõªÊ©ü‰∏ª‰ªª", "Ë™≤Ëºî"]
        };

        function doLogin() {
            if(document.getElementById('pass').value === AUTH) {
                document.getElementById('login-wall').style.display='none';
                document.getElementById('main-content').style.display='flex';
                init();
            } else alert("ÂØÜÁ¢ºÈåØË™§");
        }

        function init() {
            const chart = document.getElementById('chart');
            [13, 41].forEach(id => {
                const s = document.getElementById(`s-${id}`);
                s.className = 'special-seat present';
                s.innerHTML = `<span class="seat-no">${id}</span><div class="seat-name" style="font-size:0.65rem; margin-left:5px;">${students[id].substring(1)}</div>`;
            });

            seatMapping.forEach(id => {
                const seat = document.createElement('div');
                if (id === 0) {
                    seat.style.opacity = "0";
                } else {
                    seat.className = 'seat present';
                    seat.id = `s-${id}`;
                    seat.innerHTML = `<span class="seat-no">${id}</span><div class="seat-name">${students[id]}</div>`;
                    seat.onclick = () => toggleSeat(id);
                }
                chart.appendChild(seat);
            });
            updateStats();
            updateTime();
            setInterval(updateTime, 1000);
        }

        function toggleSeat(id) {
            const seat = document.getElementById(`s-${id}`);
            if(seat.classList.contains('present')) seat.classList.replace('present', 'absent');
            else if(seat.classList.contains('absent')) seat.classList.replace('absent', 'late');
            else seat.classList.replace('late', 'present');
            updateStats();
        }

        function updateStats() {
            const lates = document.querySelectorAll('.late');
            document.getElementById('p-count').innerText = document.querySelectorAll('.present').length;
            document.getElementById('a-count').innerText = document.querySelectorAll('.absent').length;
            document.getElementById('l-count').innerText = lates.length;

            // ËôïÁêÜÈÅ≤Âà∞Ê∏ÖÂñÆÈ°ØÁ§∫
            const lateBox = document.getElementById('late-box');
            const lateText = document.getElementById('late-text');
            if (lates.length > 0) {
                lateBox.style.display = 'block';
                let list = [];
                lates.forEach(s => {
                    const id = s.id.split('-')[1];
                    list.push(`${id}${students[id]}`);
                });
                lateText.innerText = list.join('„ÄÅ'); // Áî®È†ìËôüÈöîÈñãÊàê‰∏ÄÊ¢ù
            } else {
                lateBox.style.display = 'none';
            }
        }

        function resetSeats() {
            if(confirm("ÈáçÁΩÆÊâÄÊúâÂ∫ß‰ΩçÁãÄÊÖãÔºü")) {
                document.querySelectorAll('.seat, .special-seat').forEach(s => {
                    s.classList.remove('absent','late');
                    s.classList.add('present');
                });
                updateStats();
            }
        }

        function updateTime() {
            const now = new Date();
            const day = now.getDay();
            const currentSecs = now.getHours()*3600 + now.getMinutes()*60 + now.getSeconds();
            document.getElementById('clock').innerText = now.toLocaleTimeString('zh-TW', {hour12:false});
            
            let lessonText = "‰ºëÊÅØÊôÇÈñì";
            let timerText = "IDLE";
            const startTimes = ["08:00", "09:00", "10:00", "11:00", "13:10", "14:10", "15:10", "16:10"];
            const endTimes = ["08:50", "09:50", "10:50", "11:50", "14:00", "15:00", "16:00", "17:00"];
            
            if (day >= 1 && day <= 5) {
                for (let i = 0; i < 8; i++) {
                    const [sh, sm] = startTimes[i].split(':').map(Number);
                    const [eh, em] = endTimes[i].split(':').map(Number);
                    const sSecs = sh*3600 + sm*60;
                    const eSecs = eh*3600 + em*60;
                    if (currentSecs >= sSecs && currentSecs < eSecs) {
                        lessonText = `${schedule[day][i]}`;
                        const diff = eSecs - currentSecs;
                        timerText = `${Math.floor(diff/60)}ÂàÜ${diff%60}Áßí`;
                        break;
                    }
                }
            }
            document.getElementById('current-lesson').innerText = lessonText;
            document.getElementById('timer').innerText = timerText;
        }
    </script>
</body>
</html>
